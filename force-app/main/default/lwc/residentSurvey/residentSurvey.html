<template>
    <div class="survey-container">
        <div class="header">
            <h2>âœ¨ Resident Experience Survey âœ¨</h2>
            <p class="subtitle">We value your feedback!</p>
        </div>

        <template if:true={isLoading}>
            <div class="spinner-container">
                <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
            </div>
        </template>

        <template if:false={isLoading}>
            <template if:false={isSubmitted}>
                <div class="form-content">
                    
                    <div class="section">
                        <label class="section-label">ğŸ½ï¸ Food Quality</label>
                        <div class="rating-group">
                            <template for:each={ratingOptions} for:item="option">
                                <button 
                                    key={option.value} 
                                    class={option.foodClass}
                                    data-field="Food_Rating__c" 
                                    data-value={option.value}
                                    onclick={handleRatingClick}>
                                    {option.label}
                                </button>
                            </template>
                        </div>
                    </div>

                    <div class="section">
                        <label class="section-label">ğŸ§¹ Cleanliness</label>
                        <div class="rating-group">
                            <template for:each={ratingOptions} for:item="option">
                                <button 
                                    key={option.value} 
                                    class={option.cleanlinessClass}
                                    data-field="Cleanliness_Rating__c" 
                                    data-value={option.value}
                                    onclick={handleRatingClick}>
                                    {option.label}
                                </button>
                            </template>
                        </div>
                    </div>

                    <div class="section">
                        <label class="section-label">ğŸ‘©â€âš•ï¸ Staff Kindness</label>
                        <div class="rating-group">
                            <template for:each={ratingOptions} for:item="option">
                                <button 
                                    key={option.value} 
                                    class={option.staffClass}
                                    data-field="Staff_Rating__c" 
                                    data-value={option.value}
                                    onclick={handleRatingClick}>
                                    {option.label}
                                </button>
                            </template>
                        </div>
                    </div>

                    <div class="section">
                        <label class="section-label">âš½ Activities</label>
                        <div class="rating-group">
                            <template for:each={ratingOptions} for:item="option">
                                <button 
                                    key={option.value} 
                                    class={option.activitiesClass}
                                    data-field="Activities_Rating__c" 
                                    data-value={option.value}
                                    onclick={handleRatingClick}>
                                    {option.label}
                                </button>
                            </template>
                        </div>
                    </div>

                    <div class="section">
                        <label class="section-label">ğŸ’¬ Overall Satisfaction</label>
                        <div class="picklist-container">
                            <select onchange={handleOverallChange} class="custom-select">
                                <option value="">Select an option...</option>
                                <option value="Very Satisfied">ğŸŒŸ Very Satisfied</option>
                                <option value="Satisfied">ğŸ™‚ Satisfied</option>
                                <option value="Neutral">ğŸ˜ Neutral</option>
                                <option value="Dissatisfied">ğŸ™ Dissatisfied</option>
                                <option value="Very Dissatisfied">ğŸ˜  Very Dissatisfied</option>
                            </select>
                        </div>
                    </div>

                    <div class="section">
                        <label class="section-label">ğŸ“ Additional Comments</label>
                        <textarea 
                            class="custom-textarea" 
                            rows="3" 
                            placeholder="Tell us more about your experience..."
                            onchange={handleCommentsChange}></textarea>
                    </div>

                    <div class="footer">
                        <button class="submit-btn" onclick={handleSubmit}>Submit Feedback ğŸš€</button>
                    </div>
                </div>
            </template>

            <template if:true={isSubmitted}>
                <div class="success-message">
                    <div class="success-icon">ğŸ‰</div>
                    <h3>Thank You!</h3>
                    <p>Your feedback helps us improve.</p>
                </div>
            </template>
        </template>
    </div>
</template>
